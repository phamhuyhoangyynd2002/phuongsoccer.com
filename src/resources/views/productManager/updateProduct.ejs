<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= locals.title%></title>
    <link rel="stylesheet" href="/font/fontawesome-free-6.2.0-web/css/all.min.css">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/responsive.css">
</head>
<body>
    <header>
        <%- include('../partials/header') -%>
    </header>
    <main>
      <form method="POST" action= "/productmanager/updateproduct" enctype="multipart/form-data">
        <div class="submitproduct">
          <div class="title ms-3 mt-5 pb-sm-3 border-bottom">
            <h3 class="mb-2">Cập nhật sản phẩm</h3>
            <span class="text-secondary">Khi bạn cập nhật sản phẩm ở đây nó sẽ được tải lên website của bạn.</span>
          </div>
    
          <div class="d-flex">
            <div class="info-product m-2">
                <input type="number" name="id" value="<%- product.id %>" hidden>
                <div class="mb-4">
                  <label class="form-label">Tên sản phẩm</label>
                  <input type="text" class="form-control" name = "name" value="<%- product.name %>">
                </div>
    
                <div class="mb-4">
                  <label class="form-label">Mã sản phẩm</label>
                  <input type="text" class="form-control" name = "code" value="<%- product.code %>">
                </div>
    
                <div class="mb-4">
                  <label class="form-label">Loại sản phẩm</label>
                  <select type="number" class="form-select" aria-label="<%- product.id_tag %>" name = "id_tag" value="<%- product.id_tag %>">
                    
                    <option value = 1>giày sân tự nhiên</option>
                    <option value = 2>giày sân nhân tạo</option>
                    <option value = 3>giày futsal</option>
                    <option value = 4>giày sneaker</option>
                    <option value = 5>dép thể thao</option>
                    <option value = 6>dép thời trang</option>
                    <option value = 7>tất</option>
                    <option value = 8>găng tay</option>
                    <option value = 9>băng cuốn</option>
                    <option value = 10>túi</option>
                  </select>
                </div>
    
                <div class="mb-4">
                  <label class="form-label">Tên thương hiệu</label>
                  <select type="number" class="form-select" aria-label="<%- product.id_producer %>" name = "id_Producer" value="<%- product.id_producer %>">
                    <option value = 1>Nike</option>
                    <option value = 2>Adidas</option>
                    <option value = 3>Converse</option>
                    <option value = 4>Vans</option>
                    <option value = 5>Puma</option>
                    <option value = 6>Fila</option>
                    <option value = 7>Mlb</option>
                    <option value = 8>New-balance</option>
                    <option value = 9>Mizuno</option>
                  </select>
                </div>
    
                <div class="mb-4">
                  <label class="form-label">Mô tả sản phẩm</label>
                  <input type="text" style="height: 100px;" class="form-control" name = "description" value="<%- product.description %>">
                </div>
            </div>
    
            <div class="product-details m-2">
              <div class="mb-3" >
                <label class="form-label">Ảnh đại diện sản phẩm</label>
                <input class="form-control" type="file" name="product_Image" >
              </div>
            
              <div class="mb-5">
                <label for="formFileMultiple" class="form-label">Ảnh chi tiết phẩm (đủ 3 ảnh trên trước sau)</label>
                <input class="form-control" type="file" id="formFileMultiple" name="image" multiple>
              </div>
        
              <div class="d-flex detail_add">
                <div class="add me-1">
                  <div class="input-group mb-4">
                    <span class="input-group-text">Size</span>
                    <select type="text" id="size-input" class="form-select" aria-label="Default select example" name = "size">
                      <option value = "5US">5US</option>
                      <option value = "5.5US">5.5US</option>
                      <option value = "6US">6US</option>
                      <option value = "6.5US">6.5US</option>
                      <option value = "7US">7US</option>
                      <option value = "7.5US">7.5US</option>
                      <option value = "8US">8US</option>
                      <option value = "8.5US">8.5US</option>
                      <option value = "9US">9US</option>
                      <option value = "9.5US">9.5US</option>
                      <option value = "10US">10US</option>
                      <option value = "10.5US">10.5US</option>
                    </select>
                  </div>

                  <div class="input-group mb-4">
                    <span class="input-group-text">Giá</span>
                    <input type="number" id="price-input" class="form-control" name = "price" value = 0>
                  </div>

                  <div class="input-group mb-4">
                    <span class="input-group-text">Khuyến mãi(%)</span>
                    <input type="number" id="discount-percent-input" class="form-control" name = "discout_percent" value = 0>
                  </div>
                  
                  <div class="input-group mb-5">
                    <span class="input-group-text">Khuyến mãi trực tiếp</span>
                    <input type="number" id="discount-minus-input" class="form-control" name = "discount_minus" value = 0>
                  </div>

                  <div class="btn-edit me-5">
                    <button type="button" class="btn btn-success me-5" id="add-product-btn">Thêm</button>
                    <button type="button" class="btn btn-warning" id="remove-product-btn">Xóa</button>
                  </div>  
                </div>
                <input type="hidden" name="numRow" id="numRow" value= 0 >
                <table class="table table-bordered w-75 mb-0" id="detail-product-table">
                  <thead > 
                    <tr class="text-center">
                      <th style="width:1px;"></th>
                      <th>Size</th>
                      <th style="width:90px;">Giá</th>
                      <th style="width:50px;">Khuyến mãi(%)</th>
                      <th style="width:90px;">Khuyến mãi(vnd)</th>
                      <th>Trang thái</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% if(product_details !='' ) { %>
                      <% product_details.forEach(function(p_d, index) { %>
                        <tr>
                          <td>
                            <input  hidden type="number" value="<%- p_d.id %>" name="p_d_id" />
                          </td>
                          <td>
                            <input hidden  style="border: none; width:50px;" type="text" value="<%- p_d.size %>" name="p_d_size" />
                            <p><%- p_d.size %></p>
                          </td>
                          <td>
                            <input  style="border: none; width:90px;" type="number" value="<%- p_d.price + p_d.discount_minus %>" name="p_d_price" min="0" />
                          </td>
                          <td>
                            <input style="border: none; width:30px;" type="number" value="<%- p_d.discout_percent %>" name="p_d_discout_percent" min="0" max="100" />
                          </td>
                          <td>
                            <input style="border: none; width:90px;"  type="number" value="<%- p_d.discount_minus %>" name="p_d_discount_minus" min="0" />
                          </td>
                          <td>
                              <% if(p_d.onSale == true) { %>
                                <select style="border: none; width:120px;"  type="text" id="size-input" class="form-select" aria-label="Default select example" name = "p_d_onSale">
                                  <option value = "1">Đang bán</option>
                                  <option value = "0">Không bán</option>
                                </select>
                              <% } else { %>
                                <select  style="border: none; width:120px;" type="text" id="size-input" class="form-select" aria-label="Default select example" name = "p_d_onSale">
                                  <option value = "0">Không bán</option>
                                  <option value = "1">Đang bán</option>
                                </select>
                              <% } %>
                          </td>
                        </tr>
                      <% }) %>
                    <% } else { %>
                      <tr></tr>
                    <% } %>
                    
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <button type="submit" class="btn btn-primary btn-lg mb-5 ms-5">Submit</button>
        </div>
      </form>
    </main>
    <footer>
        <%- include('../partials/footer') -%>
    </footer>

    <!-- javascript -->
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>

      document.getElementById('add-product-btn').onclick = function add_row() {
          var size = document.querySelector('#size-input').value;
          var price = document.querySelector('#price-input').value;
          var discount_Percent = document.querySelector('#discount-percent-input').value;
          var discount_Minus = document.querySelector('#discount-minus-input').value;
          var table = document.getElementById('detail-product-table');
          var row = table.insertRow(1); 
          row.insertCell(0).innerHTML = '<input hidden type="number" value="0" name="p_d_id" />';          
          row.insertCell(1).innerHTML = '<input hidden style="border: none; width:50px;" type="text" name = "p_d_size" value = '+size+'> <p>'+ size+'</p>';
          row.insertCell(2).innerHTML = '<input style="border: none; width:90px;" type="number" name = "p_d_price" min="0" value = '+price+'>';
          row.insertCell(3).innerHTML = '<input style="border: none; width:30px;" type="number" name = "p_d_discout_percent" min="0" max="100"  value = '+discount_Percent+'>';
          row.insertCell(4).innerHTML = '<input style="border: none; width:90px;" type="number" name = "p_d_discount_minus" min="0" value = '+discount_Minus+'>';
          row.insertCell(5).innerHTML = '<select style="border: none; width:120px;"  type="text" id="size-input" class="form-select" aria-label="Default select example" name = "p_d_onSale"><option value = "1">Đang bán</option><option value = "0">Không bán</option></select>';
      }
      
      // remove detail products
      document.getElementById('remove-product-btn').onclick = function remove_row() {

          var table = document.getElementById('detail-product-table');
          table.deleteRow(1)
      }
    </script>
</body>
</html>
