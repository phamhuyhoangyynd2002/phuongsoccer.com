<!DOCTYPE html>
<html lang="vi" class="h-100">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    type="text/css" />
  <!-- Font awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    type="text/css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>
    <%= locals.title%>
  </title>
  <link rel="stylesheet" href="/font/fontawesome-free-6.2.0-web/css/all.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/productStyle.css">
  <link rel="stylesheet" href="/font/fontawesome-free-6.2.0-web/css/all.min.css">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/homeStyle.css">
</head>

<body>
  <header>
    <%- include('../partials/header') -%>
  </header>

  <main role="main">
    <!-- Block content - Đục lỗ trên giao diện bố cục chung, đặt tên là `content` -->
    <div class="container mt-4">
      <form class="needs-validation" name="frmthanhtoan" method="post" action="/orders/add">
        <input hidden type="number" name="numProduct" value=<%- numProduct %>>
        <div class="py-5 text-center">
          <i class="fa fa-credit-card fa-4x" aria-hidden="true"></i>
          <h2>Thanh toán</h2>
          <p class="lead">
            Vui lòng kiểm tra thông tin Khách hàng, thông tin Giỏ hàng trước
            khi Đặt hàng.
          </p>
        </div>

        <div class="row">
          <div class="col-md-6 order-md-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
              <span class="text-muted">Giỏ hàng</span>
              <span class="badge badge-secondary badge-pill">2</span>
            </h4>
            <ul class="list-group mb-3">
              <li>
                <table class="table">
                  <thead>
                    <tr>
                      <th scope="col">Sản Phẩm</th>
                      <th scope="col">Size</th>
                      <th scope="col">Đơn Giá</th>
                      <th scope="col">Số Lượng</th>
                      <th scope="col">Số Tiền</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% cartdata.forEach(function(cartdb, index) { %>
                    <tr>
                      <td id="name-product">
                        <div class="img-new img-cart"><img src="/img/<%- cartdb.product_Image %>" loading="lazy"
                            class="img-new img-cart" style="width: 100px"></div>
                        <p><%- cartdb.nane_product %></p>
                        <input hidden type="number" value="<%- cartdb.id_Products_details %>"
                          id=<%-"'id_Products_details" + cartdb.stt + "'" %> name = <%-"'id_Products_details" +
                          cartdb.stt + "'" %> >
                        <input hidden type="number" value="<%- cartdb.id %>"
                          id=<%-"'cart_id" + cartdb.id + "'" %> name = <%-"'cart_id" + cartdb.stt + "'" %> >
                      </td>
                      <td >
                        <div><%- cartdb.size %></div>
                      </td>
                      <td id= <%-"'item-price" + cartdb.stt + "'" %>>
                        <div class="min-price_"><%- cartdb.price %>vnđ</div>
                        <input hidden type="number" value="<%-cartdb.price %>" id=<%-"'_price" + cartdb.stt + "'" %>>
                      </td>
                      <td id= <%-"'quanlity" + cartdb.stt + "'" %>>
                        <div class="input-qty me-5">
                          <input style="width: 50px" type="number" min="1" onchange= <%-"'functionAmount" + cartdb.stt + "()'" %>
                            value="<%- cartdb.amount %>" id=<%-"'amount" + cartdb.stt + "'" %> name = <%-"'amount" +
                            cartdb.stt + "'" %>>
                        </div>

                      </td>
                      <td id=<%-"'payment" + cartdb.stt + "'" %>>
                        <p id=<%-"'total-price" + cartdb.stt + "'" %> > <%- cartdb.price * cartdb.amount %> vnđ</p>
                        <input hidden type="number" value = "<%- cartdb.price * cartdb.amount %>" id = <%-"'t-price" + cartdb.stt + "'" %>>
                      </td>
                    </tr>
                    <% }) %>
                  </tbody>
                </table>
              </li>
              <li class="list-group-item d-flex justify-content-between" id = "total-money" >
                <span>Tổng thành tiền</span>
                <h5 class="total-money"><%- Totalmoney %> vnđ</h5>
                <input hidden type="number" value = "<%- Totalmoney %>" >
              </li>
            </ul>

            <div class="input-group">
              <input type="text" class="form-control" placeholder="Mã khuyến mãi" />
              <div class="input-group-append">
                <button type="submit" class="btn btn-secondary">
                  Xác nhận
                </button>
              </div>
            </div>
            <h1></h1>
            <h1></h1>
            <h1></h1>
            <h1></h1>
            <button class="btn btn-primary btn-lg btn-block" type="submit">
              Đặt hàng
            </button>
          </div>
          <div class="col-md-6 order-md-1">
            <h4 class="mb-3">Thông tin khách hàng</h4>

            <div class="row">
              <div class="col-md-12">
                <label for="kh_ten">Họ tên</label>
                <input type="text" class="form-control" name="buyer_name" id="kh_ten" required />
              </div>
              <div class="col-md-12">
                <label for="kh_dienthoai">Điện thoại</label>
                <input type="number" class="form-control" name="phone_Number" id="kh_dienthoai" required />
              </div>
              <div class="col-md-12">
                <label for="kh_diachi">Địa chỉ</label>
                <input type="text" style="height: 70px;" class="form-control" name="address" id="kh_diachi" required />
              </div>
              <div class="col-md-12">
                <label for="kh_dienthoai">Ghi chú</label>
                <input type="text" style="height: 150px;" class="form-control" name="note" id="kh_dienthoai" required />
              </div>

            </div>
          </div>
      </form>
    </div>
    <!-- End block content -->
  </main>

  <footer>
    <%- include('../partials/footer') -%>
  </footer>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="../vendor/jquery/jquery.min.js"></script>
  <script src="../vendor/popperjs/popper.min.js"></script>
  <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

  <!-- Custom script - Các file js do mình tự viết -->
  <script src="../assets/js/app.js"></script>
  <script>
    function functionAmount0() {
      let itemPrice = document.querySelector('#item-price0 input').value;
      let quanlity = document.querySelector('#quanlity0 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment0 input').value;
      document.querySelector('#t-price0').setAttribute("value", totalMoney);
      document.querySelector('#total-price0').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount1() {
      let itemPrice = document.querySelector('#item-price1 input').value;
      let quanlity = document.querySelector('#quanlity1 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment1 input').value;
      document.querySelector('#t-price1').setAttribute("value", totalMoney);
      document.querySelector('#total-price1').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount2() {
      let itemPrice = document.querySelector('#item-price2 input').value;
      let quanlity = document.querySelector('#quanlity2 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment2 input').value;
      document.querySelector('#t-price2').setAttribute("value", totalMoney);
      document.querySelector('#total-price2').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount3() {
      let itemPrice = document.querySelector('#item-price3 input').value;
      let quanlity = document.querySelector('#quanlity3 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment3 input').value;
      document.querySelector('#t-price3').setAttribute("value", totalMoney);
      document.querySelector('#total-price3').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }
    
    function functionAmount4() {
      let itemPrice = document.querySelector('#item-price4 input').value;
      let quanlity = document.querySelector('#quanlity4 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment4 input').value;
      document.querySelector('#t-price4').setAttribute("value", totalMoney);
      document.querySelector('#total-price4').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount5() {
      let itemPrice = document.querySelector('#item-price5 input').value;
      let quanlity = document.querySelector('#quanlity5 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment5 input').value;
      document.querySelector('#t-price5').setAttribute("value", totalMoney);
      document.querySelector('#total-price5').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount6() {
      let itemPrice = document.querySelector('#item-price6 input').value;
      let quanlity = document.querySelector('#quanlity6 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment6 input').value;
      document.querySelector('#t-price6').setAttribute("value", totalMoney);
      document.querySelector('#total-price6').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount7() {
      let itemPrice = document.querySelector('#item-price7 input').value;
      let quanlity = document.querySelector('#quanlity7 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment7 input').value;
      document.querySelector('#t-price7').setAttribute("value", totalMoney);
      document.querySelector('#total-price7').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount8() {
      let itemPrice = document.querySelector('#item-price8 input').value;
      let quanlity = document.querySelector('#quanlity8 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment8 input').value;
      document.querySelector('#t-price8').setAttribute("value", totalMoney);
      document.querySelector('#total-price8').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }

    function functionAmount9() {
      let itemPrice = document.querySelector('#item-price9 input').value;
      let quanlity = document.querySelector('#quanlity9 input').value;

      let totalMoney = (Number)(itemPrice * quanlity);
      let total = document.querySelector('#payment9 input').value;
      document.querySelector('#t-price9').setAttribute("value", totalMoney);
      document.querySelector('#total-price9').innerHTML = totalMoney + " vnđ";
      let t = document.querySelector('#total-money input').value;
      totalMoney = totalMoney/10;
      t = t/10;
      total = total/10;
      console.log(totalMoney);
      console.log(t);
      console.log(total);
      totalMoney = (Number)(totalMoney  + t - total) *10;
      document.querySelector('h5.total-money').innerHTML = totalMoney + " vnđ";
      document.querySelector('#total-money input').setAttribute("value", totalMoney);
    }
  </script>
</body>

</html>